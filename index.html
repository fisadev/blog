<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is my personal blog.">
<meta name="viewport" content="width=device-width">
<title>Blog (fisa)</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="rss.xml">
<link rel="canonical" href="http://blog.fisadev.com/">
<!--[if lt IE 9]><script src="assets/js/html5shiv-printshiv.min.js"></script><![endif]--><link rel="prefetch" href="posts/separate-io-from-algorithms/" type="text/html">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
            <header id="header"><h1 id="brand"><a href="." title="Blog (fisa)" rel="home">

        <span id="blog-title">Blog (fisa)</span>
    </a></h1>

        
            <nav id="menu"><ul>
<li><a href="archive.html">Archive</a></li>
                <li><a href="categories/">Tags</a></li>
                <li><a href="rss.xml">RSS feed</a></li>

    
    
    
    </ul></nav></header><main id="content"><div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/separate-io-from-algorithms/" class="u-url">Separate IO from algorithms</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Juan Pedro Fisanotti
            </span></p>
            <p class="dateline">
            <a href="posts/separate-io-from-algorithms/" rel="bookmark">
            <time class="published dt-published" datetime="2022-02-14T17:55:50-03:00" itemprop="datePublished" title="2022-02-14 17:55">2022-02-14 17:55</time></a>
            </p>
                <p class="commentline">        <a href="posts/separate-io-from-algorithms/#disqus_thread" data-disqus-identifier="cache/posts/separate-io-from-algorithms.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>This is an old post I wrote for the Machinalis blog. Machinalis was a company I worked at some years ago, that later on got acquired by Mercado Libre. The old post is no longer online, so I replicated it here to keep it somewhere on the web :)</p>
<section id="separate-io-from-algorithms"><h2>Separate IO from algorithms</h2>
<p>Being able to write clean, easy to maintain code is one of the most important skills a developer should have. And it isn’t an easy task to accomplish. We will often be presented with complex problems in which there is no clear “clean” solution. But at the same time, there are some simple practices that can help a lot in the path to better code.</p>
<p>In this post we will talk about one of those practices: separating IO code from algorithms. It’s not rocket science, and many will probably find this obvious. But experience shows that it’s something too often overlooked, and when that happens, the code tends to become messy quite fast.</p>
<section id="a-not-so-real-example"><h3>A not-so-real example</h3>
<p>Let’s start with a hypothetical task (later on we will look at a more real example). It will be something quite simple, but bear in mind I’m using it as a vehicle to present some ideas. In real life I would probably just use <code class="docutils literal">collections.Counter</code> and the csv module :)</p>
<p>Imagine we have a .csv file, in which each line has the name of a developer and the language he uses:</p>
<pre class="code text"><a id="rest_code_06d02620175e49ef8f31dc3a50e928b9-1" name="rest_code_06d02620175e49ef8f31dc3a50e928b9-1"></a>Guido Van Rossum,Python
<a id="rest_code_06d02620175e49ef8f31dc3a50e928b9-2" name="rest_code_06d02620175e49ef8f31dc3a50e928b9-2"></a>Dennis Ritchie,C
<a id="rest_code_06d02620175e49ef8f31dc3a50e928b9-3" name="rest_code_06d02620175e49ef8f31dc3a50e928b9-3"></a>Armin Ronacher,Python
<a id="rest_code_06d02620175e49ef8f31dc3a50e928b9-4" name="rest_code_06d02620175e49ef8f31dc3a50e928b9-4"></a>Larry Wall,Perl
<a id="rest_code_06d02620175e49ef8f31dc3a50e928b9-5" name="rest_code_06d02620175e49ef8f31dc3a50e928b9-5"></a>...
</pre>
<p>And we are asked to develop a small program that counts how many developers each language has. It must produce these results via standard output:</p>
<pre class="code text"><a id="rest_code_8da7175944c04876bbf1bf69a937b777-1" name="rest_code_8da7175944c04876bbf1bf69a937b777-1"></a>Python:2
<a id="rest_code_8da7175944c04876bbf1bf69a937b777-2" name="rest_code_8da7175944c04876bbf1bf69a937b777-2"></a>Perl:1
<a id="rest_code_8da7175944c04876bbf1bf69a937b777-3" name="rest_code_8da7175944c04876bbf1bf69a937b777-3"></a>C:1
<a id="rest_code_8da7175944c04876bbf1bf69a937b777-4" name="rest_code_8da7175944c04876bbf1bf69a937b777-4"></a>...
</pre>
<p>The code we would write to solve the task could be something like this:</p>
<pre class="code python"><a id="rest_code_0768248d23bc4c0c9759197d02b80909-1" name="rest_code_0768248d23bc4c0c9759197d02b80909-1"></a><span class="k">def</span> <span class="nf">count_developers</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
<a id="rest_code_0768248d23bc4c0c9759197d02b80909-2" name="rest_code_0768248d23bc4c0c9759197d02b80909-2"></a>    <span class="n">quantities</span> <span class="o">=</span> <span class="p">{}</span>
<a id="rest_code_0768248d23bc4c0c9759197d02b80909-3" name="rest_code_0768248d23bc4c0c9759197d02b80909-3"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">developers_file</span><span class="p">:</span>
<a id="rest_code_0768248d23bc4c0c9759197d02b80909-4" name="rest_code_0768248d23bc4c0c9759197d02b80909-4"></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">developers_file</span><span class="p">:</span>
<a id="rest_code_0768248d23bc4c0c9759197d02b80909-5" name="rest_code_0768248d23bc4c0c9759197d02b80909-5"></a>            <span class="n">developer</span><span class="p">,</span> <span class="n">language</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
<a id="rest_code_0768248d23bc4c0c9759197d02b80909-6" name="rest_code_0768248d23bc4c0c9759197d02b80909-6"></a>            <span class="k">if</span> <span class="n">language</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">quantities</span><span class="p">:</span>
<a id="rest_code_0768248d23bc4c0c9759197d02b80909-7" name="rest_code_0768248d23bc4c0c9759197d02b80909-7"></a>                <span class="n">quantities</span><span class="p">[</span><span class="n">language</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="rest_code_0768248d23bc4c0c9759197d02b80909-8" name="rest_code_0768248d23bc4c0c9759197d02b80909-8"></a>            <span class="n">quantities</span><span class="p">[</span><span class="n">language</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="rest_code_0768248d23bc4c0c9759197d02b80909-9" name="rest_code_0768248d23bc4c0c9759197d02b80909-9"></a>
<a id="rest_code_0768248d23bc4c0c9759197d02b80909-10" name="rest_code_0768248d23bc4c0c9759197d02b80909-10"></a>    <span class="k">for</span> <span class="n">language</span><span class="p">,</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="n">quantities</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="rest_code_0768248d23bc4c0c9759197d02b80909-11" name="rest_code_0768248d23bc4c0c9759197d02b80909-11"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="si">{l}</span><span class="s1">: </span><span class="si">{q}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">language</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">quantity</span><span class="p">))</span>
</pre>
<p>And it works, it gets the job done. Even more: it looks like simple code, clean code.</p>
<p>But it has some not-so-obvious problems:</p>
<ul class="simple">
<li><p>What if we want to write tests for it? That would be a problem: the tests would either have to create a file to use as input, and capture the standard output to check the results, or use lots of complex mocking to avoid the interaction with real files and real standard output.</p></li>
<li><p>What if at some point we need to count developers from a different source, like a json API response? We would need to create a .csv file just to be able to feed it into this function, even if our input data doesn’t come in a file.</p></li>
<li><p>What if we need to use the output in a different way instead of showing it to the user via standard output? This function forces the results to be shown in that particular way.</p></li>
</ul>
<p>All these issues have the same root: our code is doing two things at the same time, that should be separated. Our program is dealing with the IO logic (reading files, showing results) and the algorithms itself (the “business logic”) in a single piece of code.</p>
<p>In this simple example it would be trivial to refactor the code to solve any of those issues. But that kind of refactors (changes to the input and output formats of a piece of business logic) tends not to be so trivial in real life code.</p>
<p>A better approach is then to follow that simple rule we mentioned in the beginning: to separate IO code from algorithms. Following that rule, our solution would look more like this:</p>
<pre class="code python"><a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-1" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-1"></a><span class="k">def</span> <span class="nf">read_developers_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-2" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-2"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">developers_file</span><span class="p">:</span>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-3" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-3"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-4" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-4"></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">developers_file</span><span class="p">]</span>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-5" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-5"></a>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-6" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-6"></a><span class="k">def</span> <span class="nf">count_developers</span><span class="p">(</span><span class="n">developers</span><span class="p">):</span>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-7" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-7"></a>    <span class="n">quantities</span> <span class="o">=</span> <span class="p">{}</span>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-8" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-8"></a>    <span class="k">for</span> <span class="n">developer</span><span class="p">,</span> <span class="n">language</span> <span class="ow">in</span> <span class="n">developers</span><span class="p">:</span>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-9" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-9"></a>        <span class="k">if</span> <span class="n">language</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">quantities</span><span class="p">:</span>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-10" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-10"></a>            <span class="n">quantities</span><span class="p">[</span><span class="n">language</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-11" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-11"></a>        <span class="n">quantities</span><span class="p">[</span><span class="n">language</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-12" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-12"></a>    <span class="k">return</span> <span class="n">quantities</span>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-13" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-13"></a>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-14" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-14"></a><span class="k">def</span> <span class="nf">show_report</span><span class="p">(</span><span class="n">quantities</span><span class="p">):</span>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-15" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-15"></a>    <span class="k">for</span> <span class="n">language</span><span class="p">,</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="n">quantities</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-16" name="rest_code_95fbda94cd6a443fa09cb2acc58c9c53-16"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="si">{l}</span><span class="s1">: </span><span class="si">{q}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">language</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">quantity</span><span class="p">))</span>
</pre>
<p>In this new solution, we clearly divided our code in three blocks: the code dealing with the input file, the counting algorithm itself (business logic), and the code dealing with the output of the results. We can easily test the business logic without mocking or doing real IO. We can easily reuse the business logic in scenarios where the input or output formats are different. Even if we have to support input data coming from a stream, something quite difficult with the previous approach, we could achieve that with simple refactors. This separation leaves the door open for changes in a way the old code didn’t.</p>
</section><section id="a-real-example"><h3>A real example</h3>
<p>A very common scenario in which this rule is neglected, leading to really ugly code, slow and complex tests, and overall difficult to maintain code, are Django views. Developers too often write much of the business logic of their web apps right into the views. At first sight this doesn’t look “that bad”, the code is clean, simple. It’s just a view doing business stuff. But as we saw before, problems start to arise when we need to write tests, or reuse that business logic in slightly different scenarios.</p>
<p>When writing the tests, people usually just rely on the <code class="docutils literal">django.test.client</code> to solve the “I need to do IO to test this logic” issue. The test client is great, it really solves the need of having to test a view. But the problem is: we shouldn’t be testing a view, when we just need to test a piece of business logic. We are doing lots of unnecessary extra work (url resolving, middlewares, etc), and complicating the test code, when it could have been just a function call.</p>
<p>And as you can imagine, things get really messy when we need to reuse that business logic that’s buried inside the view.</p>
<p>So, instead of writing views like this:</p>
<pre class="code python"><a id="rest_code_d80d178ce8e54868bda3a08ddd779595-1" name="rest_code_d80d178ce8e54868bda3a08ddd779595-1"></a><span class="k">def</span> <span class="nf">update_score</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span>
<a id="rest_code_d80d178ce8e54868bda3a08ddd779595-2" name="rest_code_d80d178ce8e54868bda3a08ddd779595-2"></a>    <span class="c1"># logic to get the current score</span>
<a id="rest_code_d80d178ce8e54868bda3a08ddd779595-3" name="rest_code_d80d178ce8e54868bda3a08ddd779595-3"></a>    <span class="c1"># logic to get the matches won</span>
<a id="rest_code_d80d178ce8e54868bda3a08ddd779595-4" name="rest_code_d80d178ce8e54868bda3a08ddd779595-4"></a>    <span class="c1"># score = a little extra code calculating the new score</span>
<a id="rest_code_d80d178ce8e54868bda3a08ddd779595-5" name="rest_code_d80d178ce8e54868bda3a08ddd779595-5"></a>    <span class="c1"># some more score updating</span>
<a id="rest_code_d80d178ce8e54868bda3a08ddd779595-6" name="rest_code_d80d178ce8e54868bda3a08ddd779595-6"></a>    <span class="c1"># the last bits of the score update</span>
<a id="rest_code_d80d178ce8e54868bda3a08ddd779595-7" name="rest_code_d80d178ce8e54868bda3a08ddd779595-7"></a>    <span class="n">returnrender</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">'score.html'</span><span class="p">,</span> <span class="p">{</span><span class="s1">'score'</span><span class="p">:</span><span class="n">score</span><span class="p">})</span>
</pre>
<p>We should always try to write views more similar to this:</p>
<pre class="code python"><a id="rest_code_3b1573253267449c9a3ffe5f8e7dd32e-1" name="rest_code_3b1573253267449c9a3ffe5f8e7dd32e-1"></a><span class="kn">import</span> <span class="nn">score_logic</span>
<a id="rest_code_3b1573253267449c9a3ffe5f8e7dd32e-2" name="rest_code_3b1573253267449c9a3ffe5f8e7dd32e-2"></a>
<a id="rest_code_3b1573253267449c9a3ffe5f8e7dd32e-3" name="rest_code_3b1573253267449c9a3ffe5f8e7dd32e-3"></a><span class="k">def</span> <span class="nf">update_score</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span>
<a id="rest_code_3b1573253267449c9a3ffe5f8e7dd32e-4" name="rest_code_3b1573253267449c9a3ffe5f8e7dd32e-4"></a>    <span class="n">score</span> <span class="o">=</span> <span class="n">score_logic</span><span class="o">.</span><span class="n">update_score</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
<a id="rest_code_3b1573253267449c9a3ffe5f8e7dd32e-5" name="rest_code_3b1573253267449c9a3ffe5f8e7dd32e-5"></a>    <span class="n">returnrender</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">'score.html'</span><span class="p">,</span> <span class="p">{</span><span class="s1">'score'</span><span class="p">:</span><span class="n">score</span><span class="p">})</span>
</pre></section><section id="conclusion"><h3>Conclusion</h3>
<p>Separating IO from algorithms might sound like an obvious advice, but it isn’t, it’s a principle that is often overlooked. And specially in web apps, leading to test suites that take too much time to run, and code that is indeed very hard to maintain.</p>
<p>It’s a simple rule, easy to follow, and it does prevent serious maintainability problems. So this is my advice: never again miss a chance to separate that function (or view) into dedicated IO and algorithms blocks. Your future self will be thankful :)</p>
</section></section>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/katanas-especiales/" class="u-url">Qué tan especiales son las katanas?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Juan Pedro Fisanotti
            </span></p>
            <p class="dateline">
            <a href="posts/katanas-especiales/" rel="bookmark">
            <time class="published dt-published" datetime="2020-08-13T19:30:00-03:00" itemprop="datePublished" title="2020-08-13 19:30">2020-08-13 19:30</time></a>
            </p>
                <p class="commentline">        <a href="posts/katanas-especiales/#disqus_thread" data-disqus-identifier="cache/posts/katanas-especiales.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <a class="reference external image-reference" href="images/katanas-especiales/katana.jpg"><img alt="/images/katanas-especiales/katana.thumbnail.jpg" src="images/katanas-especiales/katana.thumbnail.jpg"></a>
<p>Hay varios aspectos posibles para responder: podemos ver qué tiene de especial desde lo físico en comparación a otras espadas, desde lo técnico (su uso) y podemos ver qué tiene de especial desde lo cultural. Voy a responder con detalle sobre el primer aspecto, un poco menos del segundo, y muy poco del tercero. Pero spoiler alert: la katana no es una espada super especial, como mucha gente quiere creer. Lamentablemente hay mucha desinformación al respecto :)</p>
<section id="lo-fisico"><h2>Lo físico</h2>
<p>Mucha gente tiene la idea de que las katanas son espadas especialmente livianas y ágiles, o increíblemente filosas, o de un metal extraordinariamente resistente o bueno, en comparación a las espadas del resto del mundo, o especialmente de la Europa medieval y del renacimiento. Lamentablemente la mayoría de estas ideas se arraigan en mitos, perpetrados por juegos, películas, y hasta instructores de artes marciales muy poco informados.</p>
<section id="peso"><h3>Peso:</h3>
<p>Respecto a su peso y agilidad: la katana típica tenía una hoja de unos 70cm, y pesaba alrededor de 1.1 o 1.2 kg. Obviamente hay mucha variación en estos números, pero son los valores más "normales" en katanas históricas.</p>
<p>Si queremos comparar eso con espadas Europeas nos encontramos con un problema: la katana es una espada de dos manos, sonaría lógico compararla contra espadas de dos manos, pero para los estándares europeos la katana tiene una hoja muy corta, del largo de una espada de una mano. Así que comparemos con ambos grupos:</p>
<p>Comparando contra espadas europeas con hojas de tamaño similar, es decir, espadas de una mano, podemos ver que la katana pesa lo mismo que una espada europea típica de ese largo. Las espadas medievales de hojas de 70cm pesaban también alrededor de 1.1 o 1.2 kg. También encontramos variación, pero de vuelta, esos son los valores normales. Así que la katana no tiene ningún tipo de construcción super liviana: pesa literalmente lo mismo que espadas europeas del mismo largo.</p>
<p>Comparando contra espadas europeas de dos manos notamos que en promedio las katanas son más livianas. Pero es una comparación injusta porque la típica espada europea de dos manos tenía una hoja de 90cm, y no 70cm como la katana. Es decir, casi un 30% más largas. Cuánto pesaba la típica espada de dos manos europea? Alrededor de 1.5kg (de vuelta, con variación). Lo que es perfectamente lógico! Para una espada con hoja un 30% más largo, es esperable que el peso sea un poco mayor, pero no por estar mal hecha o ser más "primitiva", nada de eso. Simplemente es una espada más larga, así que va a poseer más metal.</p>
<p>Respecto al balance y distribución del peso, también podemos ver que la hoja de la katana es muy similar a espadas europeas de uso comparable. Base más ancha con un poco de distal taper (afinamiento), con un balance alrededor de 10cm de la guarda.</p>
<p>Con esta información está bastante claro que la katana no es un arma más ágil o rápida que cualquier espada europea similar. Es simplemente una espada más.</p>
<a class="reference external image-reference" href="images/katanas-especiales/largos.jpeg"><img alt="/images/katanas-especiales/largos.thumbnail.jpeg" src="images/katanas-especiales/largos.thumbnail.jpeg"></a>
<p>(comparemos el largo de la hoja de la katana, respecto a otras espadas europeas. Incluso el sable victoriano de una mano tiene una hoja más larga)</p>
</section><section id="filo"><h3>Filo:</h3>
<p>Un aspecto interesante de la katana es que por su construcción, el filo de la espada está compuesto de un acero más duro que el que se usa para su espina. Esto tiene algunas ventajas respecto al filo, pero no son las ventajas que la gente suele imaginar.</p>
<p>Cualquier acero, por más blando que sea, se puede afilar hasta ser comparable un bisturí. El problema de un acero blando no es que no pueda ser filoso, sino que ese filo se va a arruinar mucho más rápido con el uso. Tener un acero muy duro en el filo, permite que ese filo dure más, que requiera menos mantenimiento.</p>
<p>En comparación a espadas europeas, el filo de las katanas suele ser un poco más duro. Ergo, suele mantenerse afilada un poco más de tiempo. Pero no es una diferencia abismal tampoco.</p>
<p>Y también esto trae problemas: un filo levemente más duro, es también un filo levemente más propenso a quebrarse. Es más probable que el filo de una katana se quiebre y se le hagan muescas, que son muy difíciles de arreglar, en golpes que una espada europea por lo general resistiría un poco mejor.</p>
<p>Y hay otro aspecto super importante a la hora de evaluar qué tan bien corta una espada: el espesor de la hoja. Una hoja más fina tiene mucha mejor capacidad de corte que una hoja gruesa, por la resistencia que debe vencer al entrar en el blanco. Y en este aspecto la katana es problemática: la hoja típica de una katana es muy gruesa en términos de espadas. Hay espadas de otras culturas, como las tulwars de la India, que son muchísimo más finas, y en la práctica por ende son muchísimo mejores cortando que lo que es una katana.</p>
</section><section id="calidad-o-resistencia-del-metal"><h3>Calidad o resistencia del metal:</h3>
<p>El mito de que el acero de las katanas es una especie de super acero increíblemente bueno, tiene pocas bases en la realidad. Lo cierto es que la materia prima que se conseguía en el Japón feudal tenía muchas inclusiones de materiales no deseados (similar a muchas partes del mundo), y el proceso de plegado tiene como objetivo remover parte de esas inclusiones, y distribuir más homogéneamente las que no se quitan. El resultado es un buen acero, sin dudas. Pero no un acero extraordinario. Cualquier acero moderno es muchísimo más puro, y el tratamiento térmico preciso moderno logra prestaciones y resistencias muchísimo mejores que las técnicas históricas de cualquier cultura, incluido Japón.</p>
<p>Mucha gente cree que ese proceso de plegado era una especie de tecnología super avanzada exclusiva de Japón, que el resto del mundo no conocía y por eso generaban aceros inferiores. Nada más equivocado: en Europa se realizaban técnicas similares (plegado, y otras incluso más complejas, como el forjado en patrón de espadas de la era vikinga). Pero con el tiempo en Europa se desarrollaron hornos que lograban aceros más puros, haciendo menos necesario el proceso de plegado. Era algo común, y que en un punto se volvió obsoleto.</p>
<a class="reference external image-reference" href="images/katanas-especiales/forjado-patron.jpg"><img alt="/images/katanas-especiales/forjado-patron.thumbnail.jpg" src="images/katanas-especiales/forjado-patron.thumbnail.jpg"></a>
<p>(forjado en patrón, técnica similar al plegado pero de mayor complejidad, muy presente en espadas vikingas)</p>
</section><section id="construccion"><h3>Construcción:</h3>
<p>En esto las katanas tienen una característica conocida por muchos, que es poco común: la diferencia en el acero del filo vs de al espina de la espada. Esto se logra utilizando aceros de diferente grado de carbono, y también realizando un templado diferenciado de la hoja (templando más el filo que la espina).</p>
<p>Esto permite lidiar con los problemas de las impurezas, generando un muy buen filo bastante duro, pero montado en una espina con un más capacidad para ceder y no quebrarse tan fácilmente.</p>
<p>Pero no es una característica exclusiva de las katanas. En Europa también existen ejemplos históricos de construcción similar: una espina central de acero más blando, con filos de acero más duro.</p>
</section><section id="curvatura"><h3>Curvatura:</h3>
<p>Un detalle pero vale la pena aclararlo: en Europa también se usaban espadas curvas, y mucho. No se trata de una innovación exclusiva de Japón, o de algo objetivamente superior que solo ellos hacían.</p>
<p>Espada recta vs espada curva es un debate que tiene cientos, si no miles de años, y en todas las culturas se dio variedad de opinión al respecto. El contexto muchas veces hizo que una u otra sean más adecuadas en diferentes lugares y épocas. En Europa, las armaduras dictaron una tendencia hacia las espadas rectas (que logran mejores estocadas, y cortes levemente inferiores), simplemente porque cortar hacia una armadura no logra nada.</p>
<a class="reference external image-reference" href="images/katanas-especiales/kriegsmesser.jpg"><img alt="/images/katanas-especiales/kriegsmesser.thumbnail.jpg" src="images/katanas-especiales/kriegsmesser.thumbnail.jpg"></a>
<p>(kriegsmesser europeo)</p>
</section><section id="proteccion"><h3>Protección:</h3>
<p>Otro aspecto relativamente interesante es la elección del estilo de guarda que tienen las katanas: un disco pequeño. Es discutible, pero por lo general se considera que ofrece un nivel mucho menor de protección en comparación a otros estilos de guardas, como la cruciforme o alternativas más elaboradas.</p>
<p>Pero más allá de la opinión que se tenga respecto a su utilidad, el tener una guarda con forma de disco no es una característica exclusiva de las katanas. Hay otros tipos de espadas asiáticas con guardas similares (como los Dao chinos).</p>
<a class="reference external image-reference" href="images/katanas-especiales/dao.jpg"><img alt="/images/katanas-especiales/dao.thumbnail.jpg" src="images/katanas-especiales/dao.thumbnail.jpg"></a>
<p>(Dao chino)</p>
</section><section id="rigidez"><h3>Rigidez:</h3>
<p>Un último aspecto interesante es que en comparación a las espadas europeas, la katana suele tener una hoja un tanto más rígida, menos elástica. Esto tiene también sus ventajas y problemas.</p>
<p>La principal ventaja es que hace más fácil cortar, es un poco más permisiva si la técnica del atacante no es tan buena. Las hojas europeas requieren mejor alineación del filo para cortar adecuadamente, mientras que con una katana se puede tener el filo un poco peor alineado (por falla de la técnica del usuario), pero igual cortar de forma efectiva. Esto la hace bastante amigable para novatos. Pero un cortador experto puede cortar igual de bien con ambas.</p>
<p>Claramente también ayuda un poco en las estocadas, ya que la flexión es energía perdida.</p>
<p>La principal desventaja es que la elasticidad de las espadas europeas las hace más duraderas. Un impacto muy fuerte lateral flexiona la hoja, pero la misma vuelve a su forma original, como un resorte. En el caso de la katana, por cómo son tratados los aceros que la componen, tiene más tendencia a doblarse y permanecer doblada en lugar de volver a su forma original.</p>
<a class="reference external image-reference" href="images/katanas-especiales/flexibilidad.jpg"><img alt="/images/katanas-especiales/flexibilidad.thumbnail.jpg" src="images/katanas-especiales/flexibilidad.thumbnail.jpg"></a>
</section></section><section id="lo-tecnico"><h2>Lo técnico</h2>
<p>Mucha gente tiene la idea de que en Japón los samurais dedicaban su vida a estudiar el combate con espada, desarrollando técnicas super avanzadas, mientras que en Europa la gente se pegaba garrotasos a lo bruto, sin técnica alguna.</p>
<p>La realidad, de vuelta, no es esa. En cambio en ambos lugares existieron y se desarrollaron artes marciales muy avanzadas de combate con espada. Sistemas completos con principios, técnicas, variaciones de estilo, etc.</p>
<p>Simplemente que en la cultura popular, las artes marciales asiáticas se difundieron y modernizaron muchísimo, mientras que las europeas fueron prácticamente olvidadas.</p>
<p>Pero hoy en día existe mucha gente practicando artes marciales históricas europeas (HEMA), utilizando manuscritos medievales y del renacimiento escritos por los mismos maestros que enseñaban en esas épocas, para revivir dichas artes.</p>
<p>Y lo interesante es que hay muchísimo en común entre ambos mundos. Hay técnicas y posturas que pueden encontrarse casi idénticas entre manuscritos japoneses e italianos. Los principios que guían ambas artes también son muy muy similares.</p>
<p>En definitiva, no existen tantas formas diferentes de usar una espada de dos manos y poco más de 1kg de manera efectiva. Quienes usaban técnicas efectivas sobrevivían, quienes no, morían. Y por ello ambas culturas luego de siglos de uso, llegaron a conclusiones relativamente similares.</p>
<a class="reference external image-reference" href="images/katanas-especiales/fiore.jpg"><img alt="/images/katanas-especiales/fiore.thumbnail.jpg" src="images/katanas-especiales/fiore.thumbnail.jpg"></a>
<p>(página del manuscrito "Il Fior di Battaglia", escrito en el 1400. Versión completa online: <a class="reference external" href="https://wiktenauer.com/wiki/Fior_di_Battaglia_(MS_Ludwig_XV_13)">Fior di Battaglia (MS Ludwig XV 13)</a> )</p>
</section><section id="lo-cultural"><h2>Lo cultural</h2>
<p>En esto puede haber una diferencia muy importante entre la katana y las espadas de Europa (no hablo de otras culturas por que no conozco tanto).</p>
<p>En Europa la espada siempre tuvo un poco de "mística", pero no al nivel de religiosidad que adquirieron las katanas en Japón.</p>
<p>Si en Europa alguien pensaba que podía hacer una espada con mejor diseño, más efectiva, la hacía y nadie lo iba a mirar como un "irrespetuoso de la cultura de la espada". Eso permitió muchísima más variación de formatos y estilos que lo que vemos en Japón. No es que en Japón las katanas no variaban, pero son muy pequeñas variaciones en comparación. Una hoja un poco más larga, una curva un poco menos pronunciada, una guarda un poco más amplia, más o menos mesas en la hoja, etc. Mientras que en Europa en el mismo tiempo, se pasó de guardas de cruz a guardas que cubrían toda la mano, al mismo tiempo había hojas curvas y rectas, hojas con filos paralelos o hojas super triangulares, muy anchas y muy angostas, cruces y pomos de decenas de formatos, etc.</p>
<p>Esto también llevó a que Japón valore y conserve muchísimo mejor sus espadas históricas, y que se desarrollen incluso artes de conservación alrededor de ellas. Una hoja del año 1500 puede verse hoy en perfectas condiciones, mantenida por generaciones de pulidores, y familias que las atesoraron con valor hasta religioso.</p>
<p>En Europa en cambio, la mayoría de las que sobrevivieron se encuentran super maltratadas, mal mantenidas, oxidadas, etc. Y por lo general, luego de años de estar tiradas o escondidas en algún lugar, sin que se les preste demasiada atención.</p>
<p>Esto contribuyó mucho al mito de que las katanas eran especialmente bien hechas, por culpa de ver hojas en estado casi perfecto de un lado, mientras que del otro solo veíamos cosas oxidadas y en estado de abandono.</p>
<a class="reference external image-reference" href="images/katanas-especiales/conservacion_katana.jpeg"><img alt="/images/katanas-especiales/conservacion_katana.thumbnail.jpeg" src="images/katanas-especiales/conservacion_katana.thumbnail.jpeg"></a>
<a class="reference external image-reference" href="images/katanas-especiales/conservacion_europea.jpeg"><img alt="/images/katanas-especiales/conservacion_europea.thumbnail.jpeg" src="images/katanas-especiales/conservacion_europea.thumbnail.jpeg"></a>
<p>(estado típico de conservación de una katana vs el estado típico de conservación de una espada europea)</p>
</section><section id="en-resumen"><h2>En resumen</h2>
<p>La katana es un arma con un lugar muy especial dentro del mundo actual de espadas, pero más por accidentes históricos y diferencias culturales, que por las características del arma en sí o de sus técnicas asociadas.</p>
</section>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/encrypt-a-dir-with-ecryptfs/" class="u-url">Encrypt a dir with Ecryptfs</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Juan Pedro Fisanotti
            </span></p>
            <p class="dateline">
            <a href="posts/encrypt-a-dir-with-ecryptfs/" rel="bookmark">
            <time class="published dt-published" datetime="2020-03-11T20:30:00-03:00" itemprop="datePublished" title="2020-03-11 20:30">2020-03-11 20:30</time></a>
            </p>
                <p class="commentline">        <a href="posts/encrypt-a-dir-with-ecryptfs/#disqus_thread" data-disqus-identifier="cache/posts/encrypt-dir.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>This is a simple tutorial on how to have an encrypted directory in your Linux, by using Ecryptfs.</p>
<p>There are many alternatives to do the same, and I'm not qualified to do a deep comparison of them.
But I've been using this solution for many years already, and it works like a charm.
It relies on command line tools only which are easy to automate.
And because it uses a mounted filesystem, it's pretty transparent to other tools (like backups,
editors, etc).
There's absolutely no need for specialized tools to work with your encrypted files.</p>
<div class="section" id="dependencies">
<h2>Dependencies</h2>
<pre class="code bash"><a name="rest_code_9445a218579e4c04bc586bfde3a2c123-1"></a>sudo apt install ecryptfs-utils
</pre>
</div>
<div class="section" id="initial-setup-one-time-only">
<h2>Initial setup (one time only)</h2>
<p>You need to do this only once to setup your dir.
After that you won't have to run these steps in your daily use.</p>
<p>First create two dirs:</p>
<ul class="simple">
<li><p>A dir where you will work with your files when the encrypted filesystem is mounted.</p></li>
<li><p>A dir where the encrypted data will live. You should <strong>never</strong> edit its contents by yourself.</p></li>
</ul>
<pre class="code bash"><a name="rest_code_13ef6b3263844ca395cb6284f37052d5-1"></a>mkdir super_secret_things
<a name="rest_code_13ef6b3263844ca395cb6284f37052d5-2"></a>mkdir super_secret_things_encrypted
</pre>
<p>Then, mount the filesystem for the first time:</p>
<pre class="code bash"><a name="rest_code_dbcb2c8b14514ad0b436efce05418a89-1"></a>sudo mount super_secret_things_encrypted super_secret_things -t ecryptfs
</pre>
<p>This will ask you a bunch of questions, these are the answers I recommend, plus some explanations:</p>
<ul class="simple">
<li><p><strong>Passphrase</strong>: whatever you want to use as password :)</p></li>
<li><p><strong>Cipher</strong>: aes (option 1. This is the algorithm used to encrypt. Aes is pretty good)</p></li>
<li><p><strong>Key bytes</strong>: 32 (option 2. The size of the key, bigger usually means harder to hack)</p></li>
<li><p><strong>Plaintext passthrough</strong>: no (this allows for non-encrypted files to be used along encrypted ones,
which I think is a bad idea. These are your super secret stuff, you need to be sure they are
always encrypted).</p></li>
<li><p><strong>Filename encryption</strong>: yes (fairly obvious. If the answer is no, people can see the names of the
files without having to know the encryption password)</p></li>
<li><p><strong>Signature confirmation</strong>: just press enter.</p></li>
<li><p>A confirmation asking whether you are sure you typed everything right, because this is the first
time ecryptfs sees you using this combination of parameters with this directory. Just say yes,
because doh, of course it's the first time.</p></li>
<li><p>And Finally, whether you want ecryptfs to remember the answer to the previous question, so it
doesn't ask you "are you sure? this is the first time..." every time you mount the encrypted dir.
Answer yes.</p></li>
</ul>
<p><strong>You will need to remember the answers</strong> you chose, to be able to re-mount the encrypted dir in
the future! For me this became muscle memory: "1 2 n y enter".</p>
<p>And that's it! Encrypted dir created!</p>
</div>
<div class="section" id="daily-use">
<h2>Daily use</h2>
<p>Whenever you need to work with your encrypted files, the steps are this:</p>
<ol class="arabic simple">
<li><p>Mount the encrypted dir</p></li>
</ol>
<pre class="code bash"><a name="rest_code_944400d3dc6f499da5912605298822d9-1"></a>sudo mount super_secret_things_encrypted super_secret_things -t ecryptfs
<a name="rest_code_944400d3dc6f499da5912605298822d9-2"></a><span class="c1"># answer "1 2 n y enter", or whatever you chose instead</span>
</pre>
<p>You can also avoid having to answer all the questions, by passing all these extra parameters:</p>
<pre class="code bash"><a name="rest_code_b8cfeb1b509b4964ae1401c6bd364576-1"></a>sudo mount super_secret_things_encrypted super_secret_things -t ecryptfs -o <span class="nv">ecryptfs_cipher</span><span class="o">=</span>aes,ecryptfs_key_bytes<span class="o">=</span><span class="m">32</span>,ecryptfs_passthrough<span class="o">=</span>n,ecryptfs_enable_filename_crypto<span class="o">=</span>y,ecryptfs_fnek_sig<span class="o">=</span>6b8de1a1e22ae45c
<a name="rest_code_b8cfeb1b509b4964ae1401c6bd364576-2"></a><span class="c1"># (the "encryptfs_fnek_sig" signature is the one that the mount command asks you to verify in the final step, when not receiving all the extra params)</span>
</pre>
<ol class="arabic simple" start="2">
<li><p>Work with your files inside <cite>super_secret_things</cite> (REMEMBER!!! never edit the contents of <cite>super_secret_things_encrypted</cite> by yourself)</p></li>
<li><p>Un-mount the encrypted dir</p></li>
</ol>
<pre class="code bash"><a name="rest_code_7464a9f3453f436587dbc09c7f0a02c7-1"></a>sudo umount super_secret_things
</pre>
<p>Of course, you can automate these into scripts, alias in your shell, etc.</p>
<p>Hope this is as useful to you as it was for me :)</p>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/daneluz-longsword-best-sword/" class="u-url">Longsword by Leonardo Daneluz, my best sword!</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Juan Pedro Fisanotti
            </span></p>
            <p class="dateline">
            <a href="posts/daneluz-longsword-best-sword/" rel="bookmark">
            <time class="published dt-published" datetime="2019-07-12T20:40:00-03:00" itemprop="datePublished" title="2019-07-12 20:40">2019-07-12 20:40</time></a>
            </p>
                <p class="commentline">        <a href="posts/daneluz-longsword-best-sword/#disqus_thread" data-disqus-identifier="cache/posts/daneluz-longsword-best-sword.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div class="section" id="the-sword">
<h2>The sword</h2>
<p>(click the photos to see the full resolution versions)</p>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/1.jpg"><img alt="/images/daneluz-longsword-best-sword/1.thumbnail.jpg" src="images/daneluz-longsword-best-sword/1.thumbnail.jpg"></a>
<p>It's a longsword made in the typical style of the year 1400, with a special reinforced tip (useful to fight against armor), and an actual medieval coin in the pommel.</p>
<p><strong>Weight:</strong> 1.515 kg.</p>
<p><strong>Length:</strong> 119.5 cm (118.5 cm not counting the pin block), 93 cm blade.</p>
<p><strong>Width:</strong> 5.55 cm at the base of the blade.Thickness: 6 mm at the base of the blade, then tapers to 3.75 mm at the thinnest point (near the center of percussion), but then thickens again to 5 mm near the tip.</p>
<p><strong>Blade steel:</strong> quenched and tempered SAE 5160.</p>
<p><strong>Guard steel:</strong> quenched and tempered AISI 1045.</p>
<p><strong>Grip:</strong> made of really hard wood (Lapacho), with both hexagonal (near the guard) and oval (near the pommel) cross sections. Covered in string to give it the texture, resin, and then cow leather above it.</p>
<p><strong>Coin:</strong> the coin in the pommel is an actual coin from the year 1180, with an image of  <a class="reference external" href="https://en.wikipedia.org/wiki/Manuel_I_Komnenos">Manuel I Komnenos</a>, a Byzantine emperor.</p>
<p><strong>Maker:</strong> Leonardo Daneluz. More of his high quality work in <a class="reference external" href="https://www.facebook.com/leonardo.daneluz/photos">his facebook page</a>.</p>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/2.jpg"><img alt="/images/daneluz-longsword-best-sword/2.thumbnail.jpg" src="images/daneluz-longsword-best-sword/2.thumbnail.jpg"></a>
<p>Gosh, I'm really happy with this sword :D</p>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/3.jpg"><img alt="/images/daneluz-longsword-best-sword/3.thumbnail.jpg" src="images/daneluz-longsword-best-sword/3.thumbnail.jpg"></a>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/4.jpg"><img alt="/images/daneluz-longsword-best-sword/4.thumbnail.jpg" src="images/daneluz-longsword-best-sword/4.thumbnail.jpg"></a>
<p>With "Il Fior Di Battaglia", a medieval martial arts manuscript from around 1400 (<a class="reference external" href="https://wiktenauer.com/wiki/Fior_di_Battaglia_(MS_Ludwig_XV_13)">you can read it online!</a>). People from that time didn't just crudely bash themselves with blunt heavy swords. In reality, swords were fairly light and agile, quite sharp, and they had very developed martial arts around their usage. Luckily many manuscripts from the time survive, which we can use to revive those martial arts (google "HEMA" if you want to see people practicing them).</p>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/5.jpg"><img alt="/images/daneluz-longsword-best-sword/5.thumbnail.jpg" src="images/daneluz-longsword-best-sword/5.thumbnail.jpg"></a>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/6.jpg"><img alt="/images/daneluz-longsword-best-sword/6.thumbnail.jpg" src="images/daneluz-longsword-best-sword/6.thumbnail.jpg"></a>
<p>Here you can see the pin, which is the end of the tang (the part of the blade that continues inside the grip). And also a glimpse of the coin (better pictures below).</p>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/7.jpg"><img alt="/images/daneluz-longsword-best-sword/7.thumbnail.jpg" src="images/daneluz-longsword-best-sword/7.thumbnail.jpg"></a>
<p>The details of the coin. A little shiny because of the oil used to keep the sword from rusting. You can see the figure of <a class="reference external" href="https://en.wikipedia.org/wiki/Manuel_I_Komnenos">Manuel I Komnenos</a>.</p>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/8.jpg"><img alt="/images/daneluz-longsword-best-sword/8.thumbnail.jpg" src="images/daneluz-longsword-best-sword/8.thumbnail.jpg"></a>
<p>With a rondel dagger, a type of dagger designed to fight people in armor, usually carried by knights and man-at-arms along this kind of swords.</p>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/9.jpg"><img alt="/images/daneluz-longsword-best-sword/9.thumbnail.jpg" src="images/daneluz-longsword-best-sword/9.thumbnail.jpg"></a>
<p>Scolari is a HEMA study/practice group that we founded in Argentina. We focus on the teachings of <a class="reference external" href="https://wiktenauer.com/wiki/Fiore_de%27i_Liberi">Fiore dei Liberi</a>, the medieval martial arts master that wrote the manuscript you saw before. <a class="reference external" href="https://www.facebook.com/scolariesgrimahistorica/">https://www.facebook.com/scolariesgrimahistorica/</a></p>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/10.jpg"><img alt="/images/daneluz-longsword-best-sword/10.thumbnail.jpg" src="images/daneluz-longsword-best-sword/10.thumbnail.jpg"></a>
<p>A better picture of the coin, before it was embedded in the pommel.</p>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/11.jpg"><img alt="/images/daneluz-longsword-best-sword/11.thumbnail.jpg" src="images/daneluz-longsword-best-sword/11.thumbnail.jpg"></a>
<p>The sword without the grip and coin. You can see how the blade goes all the way through, sticking out of the pommel. This is how historical swords were built.</p>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/12.jpg"><img alt="/images/daneluz-longsword-best-sword/12.thumbnail.jpg" src="images/daneluz-longsword-best-sword/12.thumbnail.jpg"></a>
<p>To give it its final texture, the artisan not only uses string below the leather, but also above it. After a short while, the top string is removed, and the leather keeps its texture, providing better grip but also a nicer finish.</p>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/13.jpg"><img alt="/images/daneluz-longsword-best-sword/13.thumbnail.jpg" src="images/daneluz-longsword-best-sword/13.thumbnail.jpg"></a>
<p>That's a heck of a thick point.</p>
<a class="reference external image-reference" href="images/daneluz-longsword-best-sword/14.jpg"><img alt="/images/daneluz-longsword-best-sword/14.thumbnail.jpg" src="images/daneluz-longsword-best-sword/14.thumbnail.jpg"></a>
<p>Leonardo quenching it! :)</p>
<p>He's well known for the quality and historicity of his work. If you like medieval swords, then you should definitely check <a class="reference external" href="https://www.facebook.com/leonardo.daneluz/photos">his swords</a>.</p>
<p>Hope you enjoyed it as much as I do. Bah, that's impossible :p</p>
<p>(Thanks <a class="reference external" href="https://www.facebook.com/ruththelerfotografia/">Ruth Teller</a> for most of the photos!)</p>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/virtualenvs-simplest-tutorial/" class="u-url">The simplest Virtualenv tutorial (Python 3)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Juan Pedro Fisanotti
            </span></p>
            <p class="dateline">
            <a href="posts/virtualenvs-simplest-tutorial/" rel="bookmark">
            <time class="published dt-published" datetime="2019-04-15T19:51:00-03:00" itemprop="datePublished" title="2019-04-15 19:51">2019-04-15 19:51</time></a>
            </p>
                <p class="commentline">        <a href="posts/virtualenvs-simplest-tutorial/#disqus_thread" data-disqus-identifier="cache/posts/virtualenvs-simplest-tutorial.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Python virtualenvs allow you to have isolated environments, in which you can install python libs and run your programs. This is useful when you have different projects with different requirements, and also to avoid installing python libs at system level.</p>
<p>This is how to use them in modern versions of python.</p>
<section id="what-do-i-need"><h2>What do I need?</h2>
<p>Python 3.3 or newer (older versions do have virtualenvs, but they are used in a slightly different way).</p>
</section><section id="how-do-i-create-a-new-virtualenv"><h2>How do I create a new virtualenv?</h2>
<p>Open a terminal, and run this:</p>
<pre class="code bash"><a id="rest_code_d059b129a26a4f3186d8b4cc40d0dff8-1" name="rest_code_d059b129a26a4f3186d8b4cc40d0dff8-1"></a>python3 -m venv PATH_TO_YOUR_VIRTUALENV
</pre>
<p>The path it receives as a paramenter, is the location for a folder that will be created and will contain your virtualenv inside. It will only contain the virtualenv, <strong>don't</strong> add any files inside that folder. Treat it like a "system" folder.</p>
<p>Example:</p>
<pre class="code bash"><a id="rest_code_a6e14fe7e0444394b55f83deea77e37a-1" name="rest_code_a6e14fe7e0444394b55f83deea77e37a-1"></a>python3 -m venv /home/fisa/projects/my_blog/venv
</pre>
<p>(If you are using Windows, the path would instead look something like this: <code class="docutils literal"><span class="pre">C:\Users\fisa\projects\my_blog\venv</span></code>)</p>
</section><section id="how-do-i-use-the-virtualenv"><h2>How do I use the virtualenv?</h2>
<p>Each time you open a new terminal (console) to work in your project, you need to <strong>activate</strong> the virtualenv. The command to activate the virtualenv is different for Linux/MacOS vs Windows.</p>
<p>On Linux and MacOS, run:</p>
<pre class="code bash"><a id="rest_code_5bff8a337d2045d0b4630f593ce844ce-1" name="rest_code_5bff8a337d2045d0b4630f593ce844ce-1"></a><span class="nb">source</span> PATH_TO_YOUR_VIRTUALENV/bin/activate
</pre>
<p>(if you are using fish shell, replace <code class="docutils literal">activate</code> with <code class="docutils literal">activate.fish</code> at the end of that command)</p>
<p>On Windows:</p>
<pre class="code text"><a id="rest_code_b65a4b6a896a4105892f263c49446455-1" name="rest_code_b65a4b6a896a4105892f263c49446455-1"></a>PATH_TO_YOUR_VIRTUALENV\Scripts\activate.bat
</pre>
<p>From now on, the prompt of the terminal should say something like <code class="docutils literal">(venv)</code> at the begining (with the name of your virtualenv). This indicates that you are working inside your virtualenv.</p>
<p>With your virtualenv activated, if you now install libs with pip (example: <code class="docutils literal">pip install pandas</code>), they will be installed inside the virtualenv. If you run a program inside that terminal, it will be able to import any libs installed in the virtualenv.</p>
</section><section id="that-s-it"><h2>That's it?</h2>
<p>Yep.</p>
<p>Well, there's more to it, but this is what you need to start using virtualenvs :)</p>
</section><section id="ok-but"><h2>Ok, but...</h2>
<ul class="simple">
<li><p>... how do I deactivate the virtualenv? Just close that terminal. Or run <code class="docutils literal">deactivate</code>.</p></li>
<li><p>... how do I delete the virtualenv? Just delete the folder. Nothing else is created anywhere else.</p></li>
<li><p>... can I move the virtualenv? No. Just delete it, and create a new one in the new location. Virtualenvs are disposable, don't get attached to them :) (your project should define its dependencies either in a <code class="docutils literal">requirements.txt</code> or in a <code class="docutils literal">setup.py</code>, so you can easily install all the dependencies at once in the new environment)</p></li>
</ul></section>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/using-keras-and-tensorflow-with-nvidia-gpus-under-ubuntu/" class="u-url">Using Keras and TensorFlow with Nvidia gpus under Ubuntu</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Juan Pedro Fisanotti
            </span></p>
            <p class="dateline">
            <a href="posts/using-keras-and-tensorflow-with-nvidia-gpus-under-ubuntu/" rel="bookmark">
            <time class="published dt-published" datetime="2017-11-19T09:55:28-03:00" itemprop="datePublished" title="2017-11-19 09:55">2017-11-19 09:55</time></a>
            </p>
                <p class="commentline">        <a href="posts/using-keras-and-tensorflow-with-nvidia-gpus-under-ubuntu/#disqus_thread" data-disqus-identifier="cache/posts/using-keras-and-tensorflow-with-nvidia-gpus-under-ubuntu.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div class="section" id="using-keras-and-tensorflow-with-nvidia-gpus-under-ubuntu">
<h2>Using Keras and TensorFlow with Nvidia gpus under Ubuntu</h2>
<div class="section" id="what-are-all-these-things">
<h3>What are all these things???</h3>
<ul class="simple">
<li>
<strong>Keras</strong>: the Python library that knows how to build and train artificial neural networks.</li>
<li>
<strong>TensorFlow</strong>: the Python library that knows how to do heavy computations both under cpus and gpus, used by Keras.</li>
<li>
<strong>CUDA + cuDNN</strong>: Nvidia utilities to be able to run general purpose computations in the gpu.</li>
<li>
<strong>Graphics drivers</strong>: drivers that allow your linux to access and use the graphics card.</li>
</ul>
</div>
<div class="section" id="graphics-drivers">
<h3>Graphics drivers</h3>
<p>It might be possible to use CUDA without having the graphics drivers installed, but I'm not sure how easy and stable it is.
So my recommendation is to install them first, and verify that they are working.</p>
<p>Usually it's just installing a package with <tt class="docutils literal">apt</tt>:</p>
<pre class="code text"><a name="rest_code_a81502b9bc724a95a6cf798be31e21a4-1"></a>sudo apt install nvidia-375
</pre>
<p>But if you are using an Optimus-enabled graphics card (most laptops with Nvidia cards previous to the 10xx generation),
you might need to install the <tt class="docutils literal"><span class="pre">nvidia-prime</span></tt> package too.</p>
<p>The recommended version might be higher in the future, 375 is the one I'm using right now under Ubuntu 16.10.</p>
</div>
<div class="section" id="cuda-installation">
<h3>CUDA installation</h3>
<p>Get both the CUDA installer and the cuDNN installer, from their official websites:
<a class="reference external" href="https://developer.nvidia.com/cuda-downloads">https://developer.nvidia.com/cuda-downloads</a> and <a class="reference external" href="https://developer.nvidia.com/cudnn">https://developer.nvidia.com/cudnn</a>
(you will need to register in the website and fill a survey to be able to download cuDNN).</p>
<p>The versions you need to get depend on which versions does TensorFlow support.
You can check this in the official website, at <a class="reference external" href="https://www.tensorflow.org/install/install_linux">https://www.tensorflow.org/install/install_linux</a> .</p>
<p>Once you have both installers, first run the cuda installer (replace the name of the file with the one you got):</p>
<pre class="code text"><a name="rest_code_ddcd16714e6c42d9b1f7538aa54d926f-1"></a>sudo sh ./cuda_8.0.61_375.26_linux.run --override
</pre>
<p>It will ask you a few things. Tell "no" to the installation of graphics drivers (you should already have them),
and "yes" to the creation of the symbolic link.</p>
<p>Then uncompress the cuDNN installer (a file with a name similar to <tt class="docutils literal"><span class="pre">cudnn-8.0-linux-x64-v5.1.tgz</span></tt>),
and copy its files into the <tt class="docutils literal"><span class="pre">/usr/local/cuda-8.0</span></tt> folder (you should have it from the CUDA installation).
The tar file contains subfolders, be sure to copy the files into the same subfolders in the destination.</p>
</div>
<div class="section" id="tensorflow-and-keras-installation">
<h3>TensorFlow and Keras installation</h3>
<p>Once you have the graphics drivers and CUDA, then it's easy to install TensorFlow and Keras, they are just Python packages:</p>
<pre class="code text"><a name="rest_code_b704da22b17243aaab0a9b0b3540b176-1"></a>pip install tensorflow-gpu keras
</pre>
<p>If you aren't using virtualenvs (you should!), you should add <tt class="docutils literal"><span class="pre">--user</span></tt> to that command.
I don't recommend installing the packages system-wide with <tt class="docutils literal">sudo</tt>, as with time you will probably need different versions of both
<tt class="docutils literal">tensorflow</tt> and <tt class="docutils literal">keras</tt> for different projects (they both evolve quite quickly).</p>
</div>
<div class="section" id="running-the-code">
<h3>Running the code</h3>
<p>Finally, when running your code you may need to define the <tt class="docutils literal">LD_LIBRARY_PATH</tt> environment variable, for TensorFlow to be able to
find the needed CUDA libraries:</p>
<pre class="code text"><a name="rest_code_1a915c5f85cf40b4948f0ba77d48cd8e-1"></a>LD_LIBRARY_PATH=/usr/local/cuda-8.0/lib64 python your_awesome_code.py
</pre>
<p>This is true also for Jupyter notebooks:</p>
<pre class="code text"><a name="rest_code_49849716d9684d288488386fc54876a3-1"></a>LD_LIBRARY_PATH=/usr/local/cuda-8.0/lib64 jupyter notebook
</pre>
<p>If you are unsure if your code is actually using your gpu, you can paste this snippet into a <tt class="docutils literal">test_device.py</tt> file:</p>
<pre class="code python"><a name="rest_code_dd42661bf26844de8f03e1c2bd207061-1"></a><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>
<a name="rest_code_dd42661bf26844de8f03e1c2bd207061-2"></a><span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">ConfigProto</span><span class="p">(</span><span class="n">log_device_placement</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
</pre>
<p>And then run it:</p>
<pre class="code text"><a name="rest_code_14de8d3f42144cbf97fe3b0ed32e6f98-1"></a>LD_LIBRARY_PATH=/usr/local/cuda-8.0/lib64 python test_device.py
</pre>
<p>It should print a lot of information, but in between you should see something with your graphics card name, like
<tt class="docutils literal">name: GeForce GTX 1070</tt>.</p>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/customer-and-code-quality/" class="u-url">Customer and code quality</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Juan Pedro Fisanotti
            </span></p>
            <p class="dateline">
            <a href="posts/customer-and-code-quality/" rel="bookmark">
            <time class="published dt-published" datetime="2017-09-17T16:28:30-03:00" itemprop="datePublished" title="2017-09-17 16:28">2017-09-17 16:28</time></a>
            </p>
                <p class="commentline">        <a href="posts/customer-and-code-quality/#disqus_thread" data-disqus-identifier="cache/posts/customer-and-code-quality.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>I hear this a lot in the software development community: "the customer doesn't care about the quality of the code, just about features, usability, user experience, etc.".
It has many variations, but the idea remains the same: code quality isn't a factor in the decisions of the customer (internal or external).</p>
<p>Sometimes it's even used to justify writing, or not refactoring, bad code.
Because the main thing is to give your customer some value, and code quality just doesn't do that.</p>
<p>I currently believe this is false.
I believe that <strong>customers do care</strong> about the quality of the code, even if they don't understand what code is or how does it work.</p>
<div class="section" id="cars">
<h2>Cars</h2>
<p>When buying a car, would you ask how are the wheels attached to the rest of the car?
You probably wouldn't, you don't care about that.
But what if car X had wheels so special that each time you must change a tire, you need to spend 10.000$?
Suddenly you care about wheel attachment systems.
You would even feel cheated if someone sold you this car without warning you about its wheels.</p>
<p>Well, no, you don't care about wheel attachment systems specifically.
But you don't want a car that costs lots of money each time it requires some maintainance.
You care about <strong>maintainance costs</strong>.</p>
</div>
<div class="section" id="software">
<h2>Software</h2>
<p>You probably get my point already.</p>
<p>Software, code, will need maintainance in most projects.
And we know that one of the major factors defining the time (money) required to do code maintainance, is how good it is.
Bad code costs more to maintain because it tends to have more bugs, to spawn new bugs more easily when modifying it, to be harder to read/understand how to change it, etc.</p>
<p>So the customer might have zero idea regarding what code is.
But they still <strong>care</strong>, they want software with reasonable maintainance costs and that means code that is decent enough.
And giving them bad code without warning them of its impacts in maintainance, is a way of cheating them.</p>
<p>Finally, customers tend to be unable to clearly see this relation by themselves, and developers usually don't want to tell them "this is taking too long to modify because we gave you bad quality code".
This may be the reason we got the idea that customers don't care about code, developers just usually fail to explain (or even hide) to them the strong relation between code quality and maintainance costs.
So they never come back asking for "better code".</p>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/como-saber-si-hay-un-satelite-argentino-arriba-tuyo/" class="u-url">Cómo saber si hay un satélite argentino arriba tuyo</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Juan Pedro Fisanotti
            </span></p>
            <p class="dateline">
            <a href="posts/como-saber-si-hay-un-satelite-argentino-arriba-tuyo/" rel="bookmark">
            <time class="published dt-published" datetime="2017-09-06T20:14:38-03:00" itemprop="datePublished" title="2017-09-06 20:14">2017-09-06 20:14</time></a>
            </p>
                <p class="commentline">        <a href="posts/como-saber-si-hay-un-satelite-argentino-arriba-tuyo/#disqus_thread" data-disqus-identifier="cache/posts/como-saber-si-hay-un-satelite-argentino-arriba-tuyo.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>No te gustaría poder ver algo como esto en tu máquina, para saber cuándo alguno de los satélites argentinos anda por el cielo que está arriba tuyo?:</p>
<a class="reference external image-reference" href="images/satelites-arriba-tuyo/preview.png"><img alt="/images/satelites-arriba-tuyo/preview.thumbnail.png" src="images/satelites-arriba-tuyo/preview.thumbnail.png"></a>
<p>Parece algo salido de una película, es re interesante para curiosear, y lo mejor de todo es que es una pavada tenerlo. Está todo disponible con programas y datos libres y gratuitos, y sin tener que hacer casi nada de trabajo. Así que les dejo los pasos para reproducirlo:</p>
<div class="section" id="programa-y-datos">
<h2>Programa y datos</h2>
<p>Primero que nada necesitamos instalar GPredict, el programa que hace todo esto. Se puede bajar desde el sitio oficial: <a class="reference external" href="http://gpredict.oz9aec.net/">http://gpredict.oz9aec.net/</a></p>
<p>Para quienes estén en Ubuntu, pueden instalarlo desde los repositorios:</p>
<pre class="code text"><a name="rest_code_07fa800a85c649a1a6bda2573341d8a3-1"></a>sudo apt install gpredict
</pre>
<p>Lo abrimos y por primera vez vamos a ver un dashboard un poco diferente al que mostré, con datos de satélites y la estación espacial internacional.
Vamos a decirle que se baje datos actualizados, así las órbitas que vemos tienen menos error: vamos al menú "Edit" &gt; "Update TLE" &gt; "From network".
Eso nos va a mostrar una ventana con el progreso de la actualización, solamente tenemos que esperar a que termine (unos segundos) y luego cerrar la ventana.</p>
<a class="reference external image-reference" href="images/satelites-arriba-tuyo/update.png"><img alt="/images/satelites-arriba-tuyo/update.thumbnail.png" src="images/satelites-arriba-tuyo/update.thumbnail.png"></a>
</div>
<div class="section" id="configurar-que-queremos-ver">
<h2>Configurar qué queremos ver</h2>
<p>Ahora solo tenemos que decirle al programa dos cosas: qué queremos ver, y dónde estamos.</p>
<p>Vamos al menú "File" &gt; "New module", lo que nos va a mostrar una ventana como esta:</p>
<a class="reference external image-reference" href="images/satelites-arriba-tuyo/new_module.png"><img alt="/images/satelites-arriba-tuyo/new_module.thumbnail.png" src="images/satelites-arriba-tuyo/new_module.thumbnail.png"></a>
<p>Rellenamos:</p>
<ul class="simple">
<li>"Module Name": nombre de nuestro dashboard.</li>
<li>"Selected Satellites": los satélites que queremos ver, que agregamos haciendo doble click en la lista de la izquierda ("Available Satellites"). Por suerte permite buscar :)
Los satélites argentinos actuales son los <strong>CUBEBUG, NUSAT y ARSAT (hay varios de cada tipo, NUSAT-3 por ejemplo es el Milanesat de Satellogic!)</strong>.</li>
</ul>
<p>Guardamos, y terminamos con algo como esta imagen:</p>
<a class="reference external image-reference" href="images/satelites-arriba-tuyo/initial_dashboard.png"><img alt="/images/satelites-arriba-tuyo/initial_dashboard.thumbnail.png" src="images/satelites-arriba-tuyo/initial_dashboard.thumbnail.png"></a>
<p>Todavía no se ve muy lindo, y falta nuestra posición. Pero ya podemos ver la posición actual de los satélites que nos interesaban!</p>
<p>Agreguemos nuestra posición. Para ello hay que editar el módulo (dashboard), lo hacemos desplegando el menú que se abre con este botón (arriba a la derecha, en la esquina del mapa) y eligiendo la opción "Configure":</p>
<a class="reference external image-reference" href="images/satelites-arriba-tuyo/menu_button.png"><img alt="/images/satelites-arriba-tuyo/menu_button.thumbnail.png" src="images/satelites-arriba-tuyo/menu_button.thumbnail.png"></a>
<p>En la ventana que se nos abre (que es la misma que cuando creamos el dashboard), hacemos click en el botón con un signo "+" que está al lado de "Ground Station".
Ello nos abre una ventana donde rellenar nuestra posición:</p>
<a class="reference external image-reference" href="images/satelites-arriba-tuyo/add_ground_station.png"><img alt="/images/satelites-arriba-tuyo/add_ground_station.thumbnail.png" src="images/satelites-arriba-tuyo/add_ground_station.thumbnail.png"></a>
<a class="reference external image-reference" href="images/satelites-arriba-tuyo/ground_station.png"><img alt="/images/satelites-arriba-tuyo/ground_station.thumbnail.png" src="images/satelites-arriba-tuyo/ground_station.thumbnail.png"></a>
<p>Lo importante a rellenar es "Name", "Latitude" y "Longitude" (datos que podemos obtener con el gps del celular, usando aplicaciones <a class="reference external" href="https://play.google.com/store/apps/details?id=com.wered.sensorsmultitool">como esta</a>). "Altitud" también es útil, pero no super importante.</p>
<p>Guardamos la ubicación, y ahora en la misma pantalla de edición del dashboard, vamos a hacer un último paso para que se vea un poco más lindo (al menos a mi gusto, jeje).
Hacemos click en el botón "Properties". Esto nos despliega una ventana, en la que solo nos interesa cambiar el valor de "Select layout":</p>
<a class="reference external image-reference" href="images/satelites-arriba-tuyo/edit_properties.png"><img alt="/images/satelites-arriba-tuyo/edit_properties.thumbnail.png" src="images/satelites-arriba-tuyo/edit_properties.thumbnail.png"></a>
<a class="reference external image-reference" href="images/satelites-arriba-tuyo/properties.png"><img alt="/images/satelites-arriba-tuyo/properties.thumbnail.png" src="images/satelites-arriba-tuyo/properties.thumbnail.png"></a>
<p>Elegimos "Map, table, polar and single sat (wide)". Guardamos todo, y listo! Ya tenemos nuestro super dashboard satelital :)</p>
<a class="reference external image-reference" href="images/satelites-arriba-tuyo/todo.png"><img alt="/images/satelites-arriba-tuyo/todo.thumbnail.png" src="images/satelites-arriba-tuyo/todo.thumbnail.png"></a>
<p>Podés dejar de leer en este punto, o si te interesa saber un poco más, debajo explico qué son las cosas más importantes que se ven en el dashboard.</p>
</div>
<div class="section" id="que-estamos-viendo-en-el-mapa">
<h2>Qué estamos viendo en el mapa?</h2>
<p>En el mapa se ven las posiciones de los satélites, y el área de la tierra que ellos "cubren". Imaginate una pelota muy grande (o un planeta, jeje): si estás muy cerca ves poco, pero si te alejás, ves mucho más.
Cuánto ves? Ves una zona de la pelota que tiene forma de círculo. Un radio de X distancia alrededor tuyo.</p>
<p>Con los sates pasa esto mismo: si están muy cerca de la tierra (como los NUSAT), ven menos de ella al mismo tiempo. Si están más lejos (como los ARSAT), ven más.
Dependiendo de qué función tenga el satélite, conviene estar más lejos o más cerca, y no hay una "mejor".
Por ejemplo, no sirve estar super lejos y cubrir un montón si lo que interesa es sacar fotos detalladas de ciudades.
Y no sirve estar re cerca y cubrir poco si lo que interesa es transmitir señales de comunicaciones.</p>
<p>Si dije que el area que cubre tiene forma de círculo, por qué no se ven como círculos en en mapa?
Los ARSAT parecieran cubrir un cuadrado, mientras que los NUSAT ven círculos o cosas más deformes dependiendo del momento!</p>
<p>Eso es culpa de la proyección que usamos en el mapa. El mapa deforma mucho la imagen, la estira más cuanto más cerca estemos del polo.
Si lo viésemos en un globo terraqueo, se verían como círculos.</p>
<p>Cosa extra que se puede ver: si hacemos click derecho en el punto de un satélite, podemos tildar la opción "Ground Track", y eso nos muestra el camino que el satélite va a recorrer
durante las próximas horas. Si lo hacemos para un ARSAT no se va a ver ningún camino, porque son sates que están siempre en el mismo lugar en el cielo! (geoestacionarios).</p>
</div>
<div class="section" id="que-estamos-viendo-alrededor">
<h2>Qué estamos viendo alrededor?</h2>
<p>Al costado hay dos cosas: un gráfico con forma de mira ("vista polar"), y un grupito de datos de un satélite.</p>
<p>El gráfico con forma de mira es el cielo que vemos desde nuestra casa, con las posiciones de los satélites que lleguemos a ver (si es que hay alguno arriba nuestro).
Si por ejemplo vivís en Argentina y pusiste tus coordenadas, deberías siempre poder ver a los dos ARSAT, y de a ratos algún otro.</p>
<p>Los datos que se ven abajo del gráfico son el detalle de algún satélite en particular.
Con el menú que tiene esa sección (botoncito con flecha hacia abajo), podemos elegir qué satélite ver.
Cosa que sorprende a la mayoría de la gente: velocidad de los NUSAT o CUBEBUG, de 7 km/s. O sea, más o menos 23000 km/h.
Un poquito rápido, suficiente como para dar la vuelta al mundo 16 veces por día (lo hacen!).</p>
<p>Otra cosa útil: podemos ver cuándo es la próxima pasada del satélite por encima nuestro (o cuánto tiempo le falta antes de irse de nuestro cielo, si justo está pasando por arriba).
Eso se ve en el campo "Next Event".</p>
<p>Y finalmente, la tabla de abajo es similar al detalle del costado. Solo que muestra datos de varios sates a la vez.</p>
<p>Espero que lo disfruten tanto como yo :)</p>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-run-keras-theano-backend-with-a-nvidia-optimus-gpu-using-cuda-under-ubuntu-1604/" class="u-url">How to run Keras (Theano backend) with a Nvidia Optimus gpu using CUDA, under Ubuntu 16.04</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Juan Pedro Fisanotti
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-run-keras-theano-backend-with-a-nvidia-optimus-gpu-using-cuda-under-ubuntu-1604/" rel="bookmark">
            <time class="published dt-published" datetime="2016-09-20T22:58:35-03:00" itemprop="datePublished" title="2016-09-20 22:58">2016-09-20 22:58</time></a>
            </p>
                <p class="commentline">        <a href="posts/how-to-run-keras-theano-backend-with-a-nvidia-optimus-gpu-using-cuda-under-ubuntu-1604/#disqus_thread" data-disqus-identifier="cache/posts/how-to-run-keras-theano-backend-with-a-nvidia-optimus-gpu-using-cuda-under-ubuntu-1604.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>I broke so many things trying to get this to work, that I need to write it down for my future self and any others who might need this.</p>
<p>This tutorial explains how to get a Keras neural network to train using your gpu, or any Theano related code for that matter, but for the special scenario of having a Nvidia Optimus enabled gpu running under Ubuntu 16.04.
Other scenarios:</p>
<ul class="simple">
<li>Under Ubuntu 16.04 and you have a Nvidia gpu which is not Optimus enabled? then some things might work, but the "Nvidia gpu drivers" section won't be useful to you.</li>
<li>Under a different distro or Ubuntu version? I would <strong>not</strong> recommend trying this.</li>
<li>Have an non-Nvidia gpu? this <strong>won't work</strong> at all.</li>
</ul>
<p>Enough presentations, lets get to work.</p>
<div class="section" id="the-example">
<h2>0. The example</h2>
<p>We will need a Keras example to check if things are working well.
Use the code from <a class="reference external" href="https://github.com/fisadev/keras_experiments">this repo</a>.</p>
<p>In that repo you will find a keras experiment (in one of the ipython notebooks), and a small script to check for gpu usage from Theano.
Both will be useful.</p>
<p><strong>Remember</strong> to create a virtualenv and <strong>install its dependencies</strong> (from the <tt class="docutils literal">requirements.txt</tt>).
You can use wheels to speed up the process. And it requires <strong>python 3</strong>.</p>
</div>
<div class="section" id="nvidia-gpu-drivers">
<h2>1. Nvidia gpu drivers</h2>
<p>We need Ubuntu to be able to use our gpu.
To achieve that, we need both the gpu drivers and the Optimus drivers.
Thing is, Optimus drivers are kind of broken right now under Ubuntu 16.04.</p>
<p>But we can get things working, with some small annoyances:</p>
<ol class="arabic simple">
<li>Disconnect any external/secondary monitors.</li>
<li>Install video and optimus drivers: <tt class="docutils literal">sudo apt install <span class="pre">nvidia-361</span> <span class="pre">nvidia-prime</span></tt>
</li>
<li>Reboot your machine and login.</li>
<li>Open the "Nvidia X Server Settings" app, go to the "PRIME Profiles" section and choose "NVIDIA".</li>
<li>Close the settings app.</li>
<li>Logout and login again, so the profile change can take effect.</li>
</ol>
<p><strong>A small annoyance</strong>: while the "NVIDIA" profile is active you cannot (at the moment) use a secondary screen.
It will crash your X server.</p>
<p><strong>Important</strong>: remember to go back to the "Intel" profile whenever you don't want to use your gpu anymore, logout and login back for it to take effect.
Otherwise, your gpu will be using lots of power for nothing.</p>
</div>
<div class="section" id="cuda">
<h2>2. CUDA</h2>
<p>We need to be able to do general purpose computation on our Nvidia gpu.
To achieve that, we need the CUDA toolkit.
Thing is, CUDA has no Ubuntu 16.04 package at the moment.</p>
<p>But we can make things work. This is Linux, after all (thanks to Martin Thoma's <a class="reference external" href="http://askubuntu.com/questions/799184/how-can-i-install-cuda-on-ubuntu-16-04">answer</a>):</p>
<ol class="arabic simple">
<li>Download CUDA from the <a class="reference external" href="https://developer.nvidia.com/cuda-downloads">Nvidia website</a>. Choose the Ubuntu 15.04 "runfile (local)" version.</li>
<li>Check the md5 sum with: <tt class="docutils literal">md5sum cuda_7.5.18_linux.run</tt>. Only continue if it is correct.</li>
<li>Run the installer and follow the instructions: <tt class="docutils literal">sudo sh cuda_7.5.18_linux.run <span class="pre">--override</span></tt>. <strong>Make sure</strong> that you say <strong>y</strong> for the symbolic link, and <strong>n</strong> to the video drivers installation.</li>
</ol>
<p>Don't worry about the warning related to the non-installation of the video drivers.
The script is somewhat dumb and doesn't detect the drivers we installed on the previous section.</p>
</div>
<div class="section" id="gcc-and-g-versions">
<h2>3. Gcc and G++ versions</h2>
<p>Guess what? Yes, more problems.</p>
<p>CUDA requires gcc to be a version up to 4.9.
Later versions won't work.
Ubuntu 16.04 ships with gcc 5.4.</p>
<p>But we can have both versions side by side, and trick CUDA to use the older versions with just some simple symlinks (thanks to <a class="reference external" href="https://twitter.com/_zzzoom_/status/765720104868904964">charlie</a> for the tip, the old solution was far more complicated).</p>
<pre class="code bash"><a name="rest_code_1cc12ab1e3b941cfb9d5a11a79cc5e3e-1"></a>sudo apt-get install gcc-4.9 g++-4.9
<a name="rest_code_1cc12ab1e3b941cfb9d5a11a79cc5e3e-2"></a>sudo ln -s /usr/bin/gcc-4.9  /usr/local/cuda/bin/gcc
<a name="rest_code_1cc12ab1e3b941cfb9d5a11a79cc5e3e-3"></a>sudo ln -s /usr/bin/g++-4.9  /usr/local/cuda/bin/g++
<a name="rest_code_1cc12ab1e3b941cfb9d5a11a79cc5e3e-4"></a>
<a name="rest_code_1cc12ab1e3b941cfb9d5a11a79cc5e3e-5"></a><span class="c1"># Work around a glibc bug (according to the theano docs)</span>
<a name="rest_code_1cc12ab1e3b941cfb9d5a11a79cc5e3e-6"></a><span class="nb">echo</span> -e <span class="s2">"\n[nvcc]\nflags=-D_FORCE_INLINES\n"</span> &gt;&gt; ~/.theanorc
</pre>
</div>
<div class="section" id="testing">
<h2>4. Testing</h2>
<p>Done! You should be able to run Theano things (including Keras neural networks) using your gpu.</p>
<p>A simple way to check if that's true, is to run the <tt class="docutils literal">test_gpu.py</tt> script from the example repo.
But don't just "run" it.
You need to tell Theano "hey, I want you to use my shiny cuda gpu".
To achieve that, run the script like this (inside your virtualenv):</p>
<pre class="code bash"><a name="rest_code_09ce7fb87a754eb0b2da12503357908e-1"></a><span class="nv">THEANO_FLAGS</span><span class="o">=</span><span class="s2">"mode=FAST_RUN,device=gpu,floatX=float32,cuda.root=/usr/local/cuda/"</span> python test_gpu.py
</pre>
<p>If everything is working, it should quickly run and output something which ends with: <tt class="docutils literal">Used the gpu</tt>.
If instead it takes a long time (~1 minute) and ends with <tt class="docutils literal">Used the cpu</tt>, then something is not working.</p>
<p>If that worked, then you can try the full example and play a little with it (should be able to run all lines without errors):</p>
<pre class="code bash"><a name="rest_code_6c60e5e4773e4fe9b44f792e8afcafaa-1"></a><span class="nv">THEANO_FLAGS</span><span class="o">=</span><span class="s2">"mode=FAST_RUN,device=gpu,floatX=float32,cuda.root=/usr/local/cuda/"</span> ipython notebook
</pre>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/suspicious-logins/" class="u-url">Suspicious logins</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Juan Pedro Fisanotti
            </span></p>
            <p class="dateline">
            <a href="posts/suspicious-logins/" rel="bookmark">
            <time class="published dt-published" datetime="2016-09-19T20:45:15-03:00" itemprop="datePublished" title="2016-09-19 20:45">2016-09-19 20:45</time></a>
            </p>
                <p class="commentline">        <a href="posts/suspicious-logins/#disqus_thread" data-disqus-identifier="cache/posts/suspicious-logins.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div class="section" id="the-interesting-story">
<h2>The "interesting" story</h2>
<p>Imagine having a main gmail account, and a handfull of extra accounts (to reserve names, to test some api stuff, etc).</p>
<p>Imagine not having used those extra accounts in years. And even more: not having used them <strong>ever</strong>. Not a single email sent, not a single external app connected to them, not any login to other sites, etc.</p>
<p>One day you decide to start using a password manager. And an open source one, which stores the data encrypted using gpg. You even create a new gpg key to encrypt them, to be sure it's safe. You sync your encrypted data into an online private git repo, because nobody could decrypt the data anyway.</p>
<p>Two days later, you receive an email from google:</p>
<a class="reference external image-reference" href="images/suspicious-logins/someone_has_your_password.png"><img alt="/images/suspicious-logins/someone_has_your_password.thumbnail.png" src="images/suspicious-logins/someone_has_your_password.thumbnail.png"></a>
<p><strong>PANIC</strong></p>
<p>(worth mentioning: I'm from Argentina, the access was from the US)</p>
<p>After some investigation, you discover:</p>
<ul class="simple">
<li>You were reusing the password from that account.</li>
<li>The way you were using the password manager, the account names weren't encrypted (the passwords were, of course).</li>
<li>By reusing it, the encrypted data is the same in all encrypted files.</li>
<li>You never used the account, but it has your name on it, easily guessable account name.</li>
</ul>
<p><strong>Conclussion</strong>: someone who has your password from another (unsafe?) service, could have either guessed your secondary account name, or gained access to the encrypted data, which has the account names in clear text. By just comparing encrypted contents, not even decrypting them, that person could have known in which other sites the leaked password could work.</p>
<p>Ok, you now think you know, you just need to change passwords on all those sites, and never ever reuse passwords again. But oh no, you know nothing. After doing it, a few days later...</p>
<p>Email: <strong>Someone has your password</strong>.</p>
<p>Again! But this time from a different account: not that one which was easily guessable and which shared the password with other sites. No. This time? An account you <strong>didn't even write down the name</strong>, not in your password manager, nor anywhere outside google itself. The password was written down in your password manager, in clear text, because you were a little clumsy and confused "user" with "password". But then again, you <strong>never wrote down the account name outside google, ever</strong>.</p>
<p>How could someone have gained access to that account? How in hell can someone know you own that account, and he can use that "username" as password for it?</p>
<p>You start to recall... There is only <strong>one</strong> place were you have references to that account: old emails you received in your inbox, when you created the account. <strong>Your inbox</strong>.</p>
<p>Think about it: Google is telling you "hey, someone knows your account and password", and you know that the account name was only present in old emails at your inbox, while the password was only written down in your trusty new password manager.</p>
<a class="reference external image-reference" href="images/suspicious-logins/scared.jpg"><img alt="/images/suspicious-logins/scared.thumbnail.jpg" src="images/suspicious-logins/scared.thumbnail.jpg"></a>
<p>NSA, is that you? Or a random hacker who really wants to steal my data? What valuable data can I have? Hell, I need to get everyone to revoke my credentials everywhere, now.</p>
</div>
<div class="section" id="the-boring-story">
<h2>The "boring" story</h2>
<p>But no. There is always a boring explanation, something simpler, that doesn't look like a CSI Cyber episode. In this case? something that looks like a bug on some internal Google services.</p>
<p>I discovered this almost by chance, while writting down a super comprehensive explanation of the things I was seeing (a 5x longer version of the interesting story). I realized I had both accounts added to my main email account, using gmail's feature to access emails from multiple sources. This feature:</p>
<a class="reference external image-reference" href="images/suspicious-logins/gmail_feature.png"><img alt="/images/suspicious-logins/gmail_feature.thumbnail.png" src="images/suspicious-logins/gmail_feature.thumbnail.png"></a>
<p>I thought: "oh! I forgot to update those settings after changing the passwords". And so I opened gmail, went to the settings, and saw the big red errors telling me that gmail wasn't able to connect to those accounts. Which was to be expected, as I changed the passwords. But something clicked inside my head: since when is gmail unable to check those accounts? what was the error?...</p>
<p>And there it was, the boring truth in all its boringness: gmail wasn't able to access the accounts from the exact same moment the "suspicious logins" happened.</p>
<p>Some might think "oh, that's to be expected as well. Google must have blocked the account as soon as the security incident was detected". But no. This feature doesn't check email every second. For my accounts, it's doing it once every day, more or less. And the failed attempt was at the exact same time the "suspicious login" happened. In <strong>both</strong> accounts. Different times each one. Too much coincidence.</p>
<p>I wasn't able to see the original error for one of the accounts, too many login errors since it because of the password change, and it only stores the last 5 of them. But for the other account the first error was still there, and it was different to the password related ones.</p>
<p>The errors after the password changes were:</p>
<pre class="code text"><a name="rest_code_3cd21b2fb4e048ce995b96abc150b9ac-1"></a>Authentication error.
<a name="rest_code_3cd21b2fb4e048ce995b96abc150b9ac-2"></a>Server returned error "[AUTH] Username and password not accepted."
</pre>
<p>But the error at the same time than the suspicious login was:</p>
<pre class="code text"><a name="rest_code_458d158fefd0445aa6b24ade0dd3d383-1"></a>Authentication error.
<a name="rest_code_458d158fefd0445aa6b24ade0dd3d383-2"></a>Server returned error "[AUTH] Web login required: https://support.google.com/mail/answer/78754"
</pre>
<p>The linked support page isn't very helpful, but if you google the error you will find some people having the same issue: after years of not using an account, the login on their pop3 client starts to fail. Maybe something changed in google's security policies, maybe it's related to new terms of service, or required security checkups. But the thing is: logins fail until you login from a browser and tweak some stuff (enabling less secure apps, etc).</p>
<p>That itself isn't the bug. The bug is flagging those pop3 logins which came <strong>from inside google</strong> (it's a gmail feature, running on their servers), as if they were "suspicious logins". They are not suspicious, they are comming from inside google, they are being made from a google server trying to execute a gmail feature.</p>
<p>Finally, how sure am I that the logins came from inside google? Well, a traceroute to the login ip took me to this host: <tt class="docutils literal"><span class="pre">mail-pa0-x218.google.com</span></tt>.</p>
<p>So yes, I'm pretty sure this was a bug. But by Cthulhu's beard, I'm <strong>happy</strong> this was a bug.</p>
</div>
<div class="section" id="in-short">
<h2>In short</h2>
<p>A gmail server tries to login to a gmail account for a gmail feature to work, and the user gets a big red email: "someone has your password". Yes, google, someone has my password. It's you.</p>
</div>
    </div>
    </article>
</div>

           <script>var disqus_shortname="fisa-blog";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script></main><footer id="footer"><p>Contents © 2022         <a href="mailto:fisadev@gmail.com">Juan Pedro Fisanotti</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
                <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-10031421-14"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-10031421-14');
    </script>
</body>
</html>
